#Checa nos seus IDS quais estão no arquivo e quais não estão


from Bio import SeqIO

def check_missing_genes(fasta_file, gene_ids_file, output_file):
    # Ler IDs de genes do arquivo .txt
    with open(gene_ids_file, 'r') as f:
        gene_ids = set(line.strip() for line in f)

    # Ler IDs de genes do arquivo FASTA
    fasta_ids = set(record.id for record in SeqIO.parse(fasta_file, "fasta"))

    # Identificar genes que estão no .txt mas não no FASTA
    missing_genes = gene_ids - fasta_ids

    # Escrever genes ausentes no arquivo de saída
    with open(output_file, 'w') as f:
        for gene in missing_genes:
            f.write(f"{gene}\n")

    print(f"Total de genes ausentes no FASTA: {len(missing_genes)}")
    print(f"Resultado salvo em {output_file}")

# Exemplo de uso
fasta_file = "A_type_P450.fasta"
gene_ids_file = "A_TYPE_LIST"
output_file = "missing_genes.txt"

check_missing_genes(fasta_file, gene_ids_file, output_file)
